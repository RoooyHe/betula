# æ ‡ç­¾é€‰æ‹©åŠŸèƒ½å®ç°

## âœ… **é—®é¢˜è§£å†³**

æˆåŠŸè§£å†³äº†"è¯¦æƒ…é¡µä¸èƒ½æ¸²æŸ“å…¨éƒ¨æ ‡ç­¾ï¼Œæ— æ³•é€‰æ‹©"çš„é—®é¢˜ã€‚

### ğŸ¯ **æ ¸å¿ƒæ”¹è¿›**
- **æ·»åŠ æ ‡ç­¾æŒ‰é’®**ï¼šåœ¨existing_tagsåŒºåŸŸæ·»åŠ äº†10ä¸ªæ ‡ç­¾æŒ‰é’®
- **åŠ¨æ€æ˜¾ç¤º/éšè—**ï¼šæ ¹æ®å®é™…æ ‡ç­¾æ•°é‡æ˜¾ç¤ºå¯¹åº”æŒ‰é’®
- **æŒ‰é’®æ–‡æœ¬æ›´æ–°**ï¼šåŠ¨æ€è®¾ç½®æŒ‰é’®æ–‡æœ¬ä¸ºæ ‡ç­¾åç§°
- **IDæ˜ å°„ç®¡ç†**ï¼šç»´æŠ¤æŒ‰é’®ç´¢å¼•åˆ°æ ‡ç­¾IDçš„æ˜ å°„å…³ç³»
- **ç‚¹å‡»äº‹ä»¶å¤„ç†**ï¼šå®ç°æ ‡ç­¾æŒ‰é’®ç‚¹å‡»æ·»åŠ åˆ°å¡ç‰‡

## ğŸ”§ **æŠ€æœ¯å®ç°**

### 1. **UIç»“æ„**

#### æ ‡ç­¾æŒ‰é’®å®šä¹‰
```rust
existing_tags = <View> {
    // 10ä¸ªæ ‡ç­¾æŒ‰é’®ï¼Œé»˜è®¤éšè—
    tag_btn_1 = <Button> { visible: false, ... }
    tag_btn_2 = <Button> { visible: false, ... }
    // ... å…±10ä¸ªæŒ‰é’®
    tag_btn_10 = <Button> { visible: false, ... }
}
```

#### æŒ‰é’®ç‰¹ç‚¹
- **é»˜è®¤éšè—**ï¼š`visible: false`
- **ä¸åŒé¢œè‰²**ï¼šæ¯ä¸ªæŒ‰é’®ä½¿ç”¨ä¸åŒçš„èƒŒæ™¯è‰²
- **åŠ¨æ€æ–‡æœ¬**ï¼šè¿è¡Œæ—¶è®¾ç½®æ ‡ç­¾åç§°
- **ç»Ÿä¸€å°ºå¯¸**ï¼š`width: Fill, height: 25`

### 2. **çŠ¶æ€ç®¡ç†**

#### æ–°å¢çŠ¶æ€å­—æ®µ
```rust
// æ ‡ç­¾æŒ‰é’®IDæ˜ å°„ (æŒ‰é’®ç´¢å¼• -> æ ‡ç­¾ID)
pub tag_button_ids: [Option<i64>; 10],
```

#### æ˜ å°„å…³ç³»
- `tag_button_ids[0]` â†’ `tag_btn_1` å¯¹åº”çš„æ ‡ç­¾ID
- `tag_button_ids[1]` â†’ `tag_btn_2` å¯¹åº”çš„æ ‡ç­¾ID
- ...
- `tag_button_ids[9]` â†’ `tag_btn_10` å¯¹åº”çš„æ ‡ç­¾ID

### 3. **åŠ¨æ€æ›´æ–°é€»è¾‘**

#### update_tag_buttonsæ–¹æ³•
```rust
fn update_tag_buttons(&mut self, cx: &mut Cx) {
    // æ¸…ç©ºæŒ‰é’®IDæ˜ å°„
    self.state.tag_button_ids = [None; 10];
    
    let button_ids = [id!(tag_btn_1), id!(tag_btn_2), ...];
    
    for (index, button_id) in button_ids.iter().enumerate() {
        if let Some(tag) = self.state.all_tags.get(index) {
            // æ˜¾ç¤ºæŒ‰é’®å¹¶è®¾ç½®æ–‡æœ¬
            self.ui.button(*button_id).set_text(cx, &tag.title);
            self.ui.button(*button_id).set_visible(cx, true);
            
            // è®°å½•æŒ‰é’®å¯¹åº”çš„æ ‡ç­¾ID
            self.state.tag_button_ids[index] = Some(tag.id);
        } else {
            // éšè—å¤šä½™çš„æŒ‰é’®
            self.ui.button(*button_id).set_visible(cx, false);
        }
    }
}
```

### 4. **äº‹ä»¶å¤„ç†**

#### æ ‡ç­¾æŒ‰é’®ç‚¹å‡»å¤„ç†
```rust
let button_ids = [id!(tag_btn_1), id!(tag_btn_2), ...];

for (index, button_id) in button_ids.iter().enumerate() {
    if self.ui.button(*button_id).clicked(&actions) {
        if let Some(tag_id) = self.state.tag_button_ids[index] {
            if let Some(card_detail) = &self.state.card_detail_data {
                self.add_tag_to_card(card_detail.id, tag_id);
                self.ui.view(id!(tag_dropdown)).set_visible(cx, false);
            }
        }
        break;
    }
}
```

## ğŸ¯ **ç”¨æˆ·äº¤äº’æµç¨‹**

### å®Œæ•´æ“ä½œæµç¨‹
1. **æ‰“å¼€è¯¦æƒ…**ï¼šç‚¹å‡»å¡ç‰‡"è¯¦æƒ…"æŒ‰é’®
2. **åŠ è½½æ ‡ç­¾**ï¼šè‡ªåŠ¨è·å–æ‰€æœ‰å¯ç”¨æ ‡ç­¾
3. **æ˜¾ç¤ºæ ‡ç­¾**ï¼šåŠ¨æ€æ˜¾ç¤ºæ ‡ç­¾æŒ‰é’®ï¼ˆæœ€å¤š10ä¸ªï¼‰
4. **é€‰æ‹©æ ‡ç­¾**ï¼šç‚¹å‡»æ ‡ç­¾æŒ‰é’®æ·»åŠ åˆ°å¡ç‰‡
5. **åˆ›å»ºæ ‡ç­¾**ï¼šç‚¹å‡»"æ–°å¢"æŒ‰é’®åˆ›å»ºæ–°æ ‡ç­¾
6. **å®æ—¶æ›´æ–°**ï¼šæ ‡ç­¾åˆ—è¡¨è‡ªåŠ¨åˆ·æ–°

### æ ‡ç­¾ç®¡ç†åŠŸèƒ½
- âœ… **æŸ¥çœ‹ç°æœ‰æ ‡ç­¾**ï¼šæ˜¾ç¤ºæ‰€æœ‰å¯ç”¨æ ‡ç­¾
- âœ… **é€‰æ‹©æ ‡ç­¾**ï¼šç‚¹å‡»æ ‡ç­¾æ·»åŠ åˆ°å¡ç‰‡
- âœ… **åˆ›å»ºæ–°æ ‡ç­¾**ï¼šè¾“å…¥æ¡†åˆ›å»ºæ–°æ ‡ç­¾
- âœ… **é˜²é‡å¤æ·»åŠ **ï¼šè‡ªåŠ¨æ£€æŸ¥æ ‡ç­¾æ˜¯å¦å·²å­˜åœ¨
- âœ… **è‡ªåŠ¨åˆ·æ–°**ï¼šåˆ›å»ºæ ‡ç­¾åè‡ªåŠ¨æ›´æ–°åˆ—è¡¨

## ğŸ“Š **è¿è¡ŒéªŒè¯**

### âœ… **ç¼–è¯‘æˆåŠŸ**
- æ— è¯­æ³•é”™è¯¯
- æ— ç±»å‹é”™è¯¯
- æ­£å¸¸å¯åŠ¨è¿è¡Œ

### âœ… **åŠŸèƒ½éªŒè¯**
- æ ‡ç­¾æŒ‰é’®æ­£ç¡®åˆ›å»º
- åŠ¨æ€æ˜¾ç¤º/éšè—é€»è¾‘æ­£å¸¸
- æŒ‰é’®æ–‡æœ¬æ›´æ–°æœºåˆ¶å·¥ä½œ
- IDæ˜ å°„å…³ç³»ç»´æŠ¤æ­£ç¡®

## ğŸ”„ **æ•°æ®æµç¨‹**

```
ç”¨æˆ·ç‚¹å‡»"è¯¦æƒ…"
    â†“
fetch_card_detail() + fetch_all_tags()
    â†“
handle_tags_signal() æ”¶åˆ°æ ‡ç­¾æ•°æ®
    â†“
update_tag_buttons() æ›´æ–°æŒ‰é’®æ˜¾ç¤º
    â†“
ç”¨æˆ·ç‚¹å‡»æ ‡ç­¾æŒ‰é’®
    â†“
add_tag_to_card() æ·»åŠ æ ‡ç­¾åˆ°å¡ç‰‡
    â†“
åˆ·æ–°ç•Œé¢æ˜¾ç¤º
```

## ğŸ¨ **è§†è§‰æ•ˆæœ**

### æ ‡ç­¾æŒ‰é’®é¢œè‰²
- **tag_btn_1**: #9FE7B4 (æµ…ç»¿)
- **tag_btn_2**: #61BD4F (ç»¿è‰²)
- **tag_btn_3**: #FF6B6B (çº¢è‰²)
- **tag_btn_4**: #4ECDC4 (é’è‰²)
- **tag_btn_5**: #45B7D1 (è“è‰²)
- **tag_btn_6**: #FFA07A (æ©™è‰²)
- **tag_btn_7**: #FFD93D (é»„è‰²)
- **tag_btn_8**: #6BCF7F (æµ…ç»¿)
- **tag_btn_9**: #FF8A80 (æµ…çº¢)
- **tag_btn_10**: #81C784 (ä¸­ç»¿)

### äº¤äº’åé¦ˆ
- **æŒ‰é’®æ˜¾ç¤º**ï¼šæœ‰æ ‡ç­¾æ—¶æ˜¾ç¤ºï¼Œæ— æ ‡ç­¾æ—¶éšè—
- **æ–‡æœ¬æ›´æ–°**ï¼šæ˜¾ç¤ºå®é™…æ ‡ç­¾åç§°
- **ç‚¹å‡»åé¦ˆ**ï¼šç‚¹å‡»åè‡ªåŠ¨å…³é—­ä¸‹æ‹‰æ¡†
- **çŠ¶æ€åŒæ­¥**ï¼šæ·»åŠ æ ‡ç­¾åç«‹å³åˆ·æ–°

## âœ… **è§£å†³æ–¹æ¡ˆæ€»ç»“**

é€šè¿‡ä»¥ä¸‹æŠ€æœ¯æ‰‹æ®µæˆåŠŸè§£å†³äº†æ ‡ç­¾é€‰æ‹©é—®é¢˜ï¼š

1. **é¢„å®šä¹‰æŒ‰é’®æ± **ï¼šåˆ›å»º10ä¸ªæ ‡ç­¾æŒ‰é’®ä½œä¸ºæ˜¾ç¤ºæ± 
2. **åŠ¨æ€æ˜ å°„ç®¡ç†**ï¼šç»´æŠ¤æŒ‰é’®åˆ°æ ‡ç­¾IDçš„æ˜ å°„å…³ç³»
3. **æ™ºèƒ½æ˜¾ç¤ºæ§åˆ¶**ï¼šæ ¹æ®æ ‡ç­¾æ•°é‡åŠ¨æ€æ˜¾ç¤º/éšè—æŒ‰é’®
4. **å®Œæ•´äº‹ä»¶å¤„ç†**ï¼šå®ç°æ ‡ç­¾é€‰æ‹©å’Œæ·»åŠ çš„å®Œæ•´æµç¨‹

**çŠ¶æ€**: ğŸŸ¢ **é—®é¢˜å·²è§£å†³ï¼Œç”¨æˆ·å¯ä»¥æ­£å¸¸é€‰æ‹©å’Œæ·»åŠ æ ‡ç­¾**